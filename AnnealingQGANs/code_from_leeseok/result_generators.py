import qutip
import numpy as np

T=5 # final time
tlist = np.linspace(0,T,50)

#target states
targ_states = []
thetas = np.linspace(0, np.pi, 9)
for t in thetas:
    psi_tt = np.cos(t)*(qutip.basis(2**3,0)) + np.sin(t)*(qutip.basis(2**3,2**3-1))
    targ_states.append(psi_tt)

targ_states=targ_states[1:-1]

#optimized pulse for target state 1:
p1 = [ [ 0.        ,  0.10518173,  0.35519724,  0.61190325,
                    0.77388663,  0.84309162,  0.86698176,  0.86779726,
                    0.85145625,  0.81604204,  0.75516727,  0.65914046,
                    0.51849588,  0.34305515,  0.17448483,  0.04404944,
                   -0.06454447, -0.18090038, -0.30413137, -0.41087737,
                   -0.49151276, -0.55631315, -0.61073505, -0.6470507 ,
                   -0.65683814, -0.63669377, -0.58577713, -0.50340993,
                   -0.38809747, -0.24565502, -0.1004811 ,  0.01298031,
                    0.07227408,  0.08075939,  0.07871168,  0.1483889 ,
                    0.34765734,  0.59018081,  0.74944734,  0.8166188 ,
                    0.82852044,  0.79361652,  0.68790563,  0.48256536,
                    0.2437068 ,  0.09159392,  0.00431302, -0.15890863,
                   -0.47363248, -0.66939958]  ,  [ 0.        , -0.02715927, -0.12312114, -0.11348015,
                    0.2488388 ,  0.67585978,  0.85888944,  0.91216215,
                    0.92997752,  0.93404189,  0.92845071,  0.90919385,
                    0.85826559,  0.71521965,  0.40752828,  0.09815399,
                   -0.03298452, -0.14178842, -0.38701586, -0.65028282,
                   -0.79691595, -0.856906  , -0.87843446, -0.87959706,
                   -0.86468198, -0.83034314, -0.76044471, -0.61859352,
                   -0.3930784 , -0.17789954, -0.05896211,  0.04641225,
                    0.27557369,  0.56814657,  0.76366967,  0.85125894,
                    0.89040855,  0.90915916,  0.9155804 ,  0.90717584,
                    0.86404581,  0.67661569,  0.17495848, -0.23567146,
                   -0.19257836, -0.02213404,  0.00599353, -0.00769038,
                    0.28298062,  0.5501793 ]  ,  [ 0.        ,  0.11013942,  0.37298766,  0.63565715,
                    0.79225311,  0.85639448,  0.87857942,  0.88036254,
                    0.867499  ,  0.83843295,  0.78679405,  0.70082707,
                    0.56443417,  0.37882293,  0.19034578,  0.04687682,
                   -0.06273148, -0.17662946, -0.30069241, -0.41050813,
                   -0.49372567, -0.55984217, -0.61144408, -0.63718636,
                   -0.62803324, -0.58335677, -0.51135385, -0.42536614,
                   -0.32849723, -0.21488488, -0.09209823,  0.0154383 ,
                    0.0844143 ,  0.1121166 ,  0.13442924,  0.23066253,
                    0.43987975,  0.659237  ,  0.78566568,  0.83167416,
                    0.82633055,  0.76184911,  0.59096034,  0.31756488,
                    0.09813491,  0.03095827, -0.00674659, -0.18225123,
                   -0.51591227, -0.71103232]  ,  [ 1.        ,  0.97675464,  0.91260616,  0.80655148,
                    0.64057465,  0.42228049,  0.23193007,  0.14084628,
                    0.11603629,  0.06106722, -0.11480977, -0.40776399,
                   -0.68821118, -0.86348121, -0.95356075, -0.99157203,
                   -0.98714074, -0.93945064, -0.83469365, -0.6359812 ,
                   -0.33885479, -0.05085184,  0.11079358,  0.15105308,
                    0.15841234,  0.23107129,  0.40710618,  0.62987421,
                    0.81338503,  0.92588403,  0.98184734,  0.99385996,
                    0.96379989,  0.88491253,  0.72882944,  0.451699  ,
                    0.08101251, -0.23752092, -0.42559926, -0.53979384,
                   -0.63168557, -0.71242974, -0.78072519, -0.84391709,
                   -0.90979504, -0.96701244, -0.99412186, -0.98120354,
                   -0.91691954, -0.8693192 ]  ,  [ 1.        ,  0.97675464,  0.91311836,  0.81531794,
                    0.68503385,  0.48235941,  0.11863483, -0.29499403,
                   -0.54873634, -0.64995203, -0.69206615, -0.73237935,
                   -0.7997679 , -0.88451614, -0.95533803, -0.99159439,
                   -0.98722186, -0.9429235 , -0.86639695, -0.77239638,
                   -0.67788835, -0.59789279, -0.53007738, -0.4359598 ,
                   -0.23789177,  0.10904036,  0.4760098 ,  0.7155912 ,
                    0.84789502,  0.93181333,  0.98210031,  0.99386836,
                    0.96521464,  0.90329739,  0.82302771,  0.73070917,
                    0.60406247,  0.36933009, -0.04028653, -0.45756004,
                   -0.69190903, -0.7885245 , -0.82893402, -0.86153644,
                   -0.91272591, -0.96717453, -0.99412242, -0.98122631,
                   -0.91876658, -0.87296774]  ,  [ 1.        ,  0.97675464,  0.91254537,  0.80550354,
                    0.6347365 ,  0.40873508,  0.21796182,  0.14014116,
                    0.13836973,  0.10969468, -0.04963056, -0.35609156,
                   -0.66727451, -0.85959462, -0.95325117, -0.99156834,
                   -0.98712755, -0.93884485, -0.82818274, -0.6045883 ,
                   -0.27107458,  0.01963986,  0.13706721,  0.11445047,
                    0.07059082,  0.1309648 ,  0.33597446,  0.59891116,
                    0.80569787,  0.92497245,  0.98181648,  0.99385901,
                    0.96363187,  0.8823527 ,  0.71239841,  0.38887524,
                   -0.04715347, -0.39815006, -0.58501308, -0.68624441,
                   -0.75097413, -0.79546806, -0.82848612, -0.86416642,
                   -0.91473116, -0.96742711, -0.99412398, -0.98130493,
                   -0.92219874, -0.87967486]  ]

#optimized pulse for target state 2:
p2 = [ [ 0.        ,  0.1074986 ,  0.34521519,  0.57711202,
                     0.72721321,  0.79515155,  0.82213755,  0.83301675,
                     0.83832962,  0.83892426,  0.82826359,  0.79207101,
                     0.70010345,  0.50841312,  0.25195181,  0.05563416,
                    -0.08075782, -0.28796212, -0.55034803, -0.7346028 ,
                    -0.81483186, -0.83653463, -0.81628531, -0.72414789,
                    -0.41758166,  0.1173271 ,  0.50939194,  0.59014324,
                     0.48274718,  0.23963346,  0.03643808,  0.04741296,
                     0.18916639,  0.22430982, -0.01741585, -0.386109  ,
                    -0.58160752, -0.48437348,  0.02243578,  0.56090583,
                     0.74519025,  0.74637458,  0.62036651,  0.33141917,
                     0.04584272, -0.02637672, -0.02816374, -0.27469049,
                    -0.68125841, -0.86801491]  ,
  [ 0.        , -0.00724088,  0.12037297,  0.48039258,
                     0.78475143,  0.88706959,  0.91874175,  0.93171392,
                     0.93897946,  0.94294744,  0.94219961,  0.93222865,
                     0.89885323,  0.78405187,  0.46462324,  0.11249211,
                    -0.05701604, -0.25130314, -0.5277799 , -0.69952227,
                    -0.73777882, -0.71286264, -0.69297439, -0.72149005,
                    -0.77189951, -0.80209423, -0.79959887, -0.75250577,
                    -0.62400926, -0.38811145, -0.13844183,  0.01457306,
                     0.12824047,  0.30137898,  0.49928927,  0.62899395,
                     0.6601164 ,  0.58854573,  0.4076833 ,  0.22072621,
                     0.16046015,  0.17928287,  0.17478943,  0.14494273,
                     0.11882335,  0.08477888,  0.0140776 , -0.07130891,
                    -0.09234144, -0.0750353 ]  ,
  [ 0.        ,  0.11752583,  0.35424   ,  0.55849311,
                     0.68239097,  0.7333474 ,  0.74711516,  0.75166163,
                     0.76262853,  0.77788655,  0.782476  ,  0.75767467,
                     0.67540726,  0.49699105,  0.25188483,  0.05721626,
                    -0.07414894, -0.26232717, -0.51274466, -0.70261053,
                    -0.79035583, -0.81487138, -0.79428956, -0.70592178,
                    -0.46225182, -0.04728192,  0.29165815,  0.3749833 ,
                     0.26345105,  0.07860126, -0.01882949,  0.02486292,
                     0.06546711, -0.11236906, -0.46325749, -0.71279288,
                    -0.78614597, -0.7350652 , -0.33734305,  0.34223542,
                     0.74282258,  0.80766118,  0.78047444,  0.6588634 ,
                     0.41332914,  0.16013604,  0.01078542, -0.18769496,
                    -0.5613083 , -0.78749921]  ,
  [ 1.        ,  0.97675464,  0.91274546,  0.8094217 ,
                     0.65958485,  0.4730734 ,  0.28241161,  0.09861972,
                    -0.10474489, -0.32965057, -0.53339033, -0.68749925,
                    -0.80055259, -0.88911612, -0.95617598, -0.99160795,
                    -0.98727233, -0.94474632, -0.87815096, -0.80633669,
                    -0.73746177, -0.67347838, -0.61434898, -0.54312484,
                    -0.40267241, -0.0983361 ,  0.30629614,  0.6268276 ,
                     0.81894154,  0.92717713,  0.98190754,  0.99386173,
                     0.96421001,  0.89439753,  0.80154087,  0.70787584,
                     0.58300653,  0.3314107 , -0.03151316, -0.32820993,
                    -0.51523037, -0.6550706 , -0.75584465, -0.83470037,
                    -0.9072824 , -0.9667155 , -0.99411994, -0.98110405,
                    -0.90839225, -0.85246354]  ,
  [ 1.        ,  0.97675464,  0.91277146,  0.80509404,
                     0.59869614,  0.22933068, -0.14794222, -0.33864398,
                    -0.38685668, -0.40912157, -0.48542818, -0.62483894,
                    -0.77164462, -0.88306712, -0.95581385, -0.99160829,
                    -0.9872806 , -0.94509295, -0.88114707, -0.81986991,
                    -0.77570258, -0.74621589, -0.71675533, -0.66152374,
                    -0.51952724, -0.16360592,  0.31164792,  0.65014573,
                     0.82882221,  0.92895639,  0.98199279,  0.99386517,
                     0.96468406,  0.89691215,  0.79325592,  0.64189855,
                     0.35327323, -0.17768235, -0.61192933, -0.74291077,
                    -0.78305233, -0.79632603, -0.80867496, -0.84548823,
                    -0.90800302, -0.9667527 , -0.99412032, -0.98112973,
                    -0.91407827, -0.86378422]  ,
  [ 1.        ,  0.97675464,  0.91289836,  0.81243992,
                     0.67949465,  0.53756575,  0.41077597,  0.28308426,
                     0.09911751, -0.16431303, -0.43824164, -0.6461446 ,
                    -0.78632011, -0.8857515 , -0.95580962, -0.99160291,
                    -0.9872544 , -0.94404749, -0.87279393, -0.78529152,
                    -0.67822162, -0.53333285, -0.31115782, -0.00323976,
                     0.27777615,  0.45654559,  0.58980959,  0.72011489,
                     0.83936775,  0.92950082,  0.98198032,  0.99386378,
                     0.96454641,  0.89769188,  0.80830417,  0.70728917,
                     0.56505338,  0.28391198, -0.13529033, -0.44768244,
                    -0.57911255, -0.66572882, -0.74738961, -0.82881776,
                    -0.9063005 , -0.96675499, -0.9941207 , -0.98114779,
                    -0.91121565, -0.85802288]  ]

#optimized pulse for target state 3:
p3 = [ [ 0.        ,  0.03175382,  0.05845938,  0.06722866,
                     0.1354112 ,  0.28354536,  0.47312484,  0.62826163,
                     0.71546112,  0.75224382,  0.75563053,  0.72565457,
                     0.64181379,  0.47121319,  0.24103625,  0.05567366,
                    -0.0766877 , -0.27592059, -0.53971658, -0.73499246,
                    -0.82564174, -0.85873127, -0.85798376, -0.81390753,
                    -0.64051057, -0.15456839,  0.3581873 ,  0.52658413,
                     0.44203142,  0.21687204,  0.03039855,  0.04655546,
                     0.18761972,  0.22586107, -0.00691347, -0.38536271,
                    -0.62756828, -0.67146044, -0.50293859,  0.03498609,
                     0.5564051 ,  0.71394912,  0.71067941,  0.6072984 ,
                     0.40131023,  0.17466672,  0.02035799, -0.13366467,
                    -0.4462324 , -0.66001189]  ,
  [ 0.        ,  0.06078111,  0.16788877,  0.28438011,
                     0.42908947,  0.55224674,  0.62199733,  0.65749521,
                     0.69951652,  0.75992037,  0.81188561,  0.83029052,
                     0.79739556,  0.65821218,  0.36343961,  0.08273566,
                    -0.07166149, -0.26991255, -0.50758068, -0.61339408,
                    -0.4994891 , -0.12099303,  0.24215683,  0.2476936 ,
                    -0.06636785, -0.41194822, -0.57863845, -0.59035187,
                    -0.47846164, -0.28284984, -0.10182503,  0.02473876,
                     0.15989114,  0.3249221 ,  0.45671036,  0.50234473,
                     0.4403779 ,  0.27105543,  0.07716996, -0.01419282,
                     0.04128546,  0.18287673,  0.30396628,  0.33570407,
                     0.27519162,  0.15424406,  0.02809862, -0.02905116,
                     0.11609346,  0.26236486]  ,
  [ 0.00000000e+00, -5.16342378e-04, -4.69691475e-02,
                    -9.84208973e-02, -2.13598337e-02,  2.29875899e-01,
                     5.30557312e-01,  7.16386084e-01,  7.88698312e-01,
                     8.08915749e-01,  7.99202811e-01,  7.57148482e-01,
                     6.58426463e-01,  4.69807072e-01,  2.31947883e-01,
                     5.18698890e-02, -8.52620071e-02, -3.04027188e-01,
                    -5.73396884e-01, -7.55663651e-01, -8.34498061e-01,
                    -8.60002803e-01, -8.51770038e-01, -7.92187732e-01,
                    -5.53502893e-01,  8.43518994e-03,  5.00502729e-01,
                     6.23803760e-01,  5.45264510e-01,  3.07269616e-01,
                     6.71453140e-02,  6.31175691e-02,  2.69146223e-01,
                     4.37291568e-01,  3.98771806e-01,  1.01279475e-01,
                    -2.90600139e-01, -4.97051333e-01, -4.15498549e-01,
                     1.73864560e-02,  4.82091448e-01,  6.49526640e-01,
                     6.32878934e-01,  4.98593879e-01,  2.88733629e-01,
                     1.14770493e-01,  7.10600881e-03, -1.73448343e-01,
                    -5.27384069e-01, -7.47855537e-01]  ,
  [ 1.        ,  0.97675464,  0.91307014,  0.81405877,
                     0.68195806,  0.52361615,  0.33396328,  0.08375552,
                    -0.21670281, -0.47846237, -0.64631614, -0.7477221 ,
                    -0.82347651, -0.89448381, -0.95671148, -0.99161483,
                    -0.98729656, -0.94561204, -0.88345009, -0.81919024,
                    -0.74673929, -0.63311359, -0.42742822, -0.10355612,
                     0.24064948,  0.48026823,  0.62558079,  0.74067565,
                     0.84589257,  0.93050255,  0.98202214,  0.99386524,
                     0.96478921,  0.90087397,  0.82447623,  0.75307342,
                     0.65788094,  0.46775291,  0.14276123, -0.19282184,
                    -0.41030073, -0.55958008, -0.69563686, -0.81185522,
                    -0.9031753 , -0.966551  , -0.99411985, -0.98111042,
                    -0.91057482, -0.85681593]  ,
  [ 1.        ,  0.97675464,  0.91301956,  0.8131312 ,
                     0.6762615 ,  0.50993594,  0.33411423,  0.16251721,
                    -0.01224652, -0.20241857, -0.40775826, -0.60602924,
                    -0.76711772, -0.88136905, -0.95546869, -0.99160062,
                    -0.98724949, -0.9438667 , -0.87271976, -0.79671393,
                    -0.74195827, -0.71440904, -0.69067   , -0.64485634,
                    -0.55793585, -0.37805285,  0.00606899,  0.48375452,
                     0.79245229,  0.92471249,  0.9818366 ,  0.99386017,
                     0.96380713,  0.88415289,  0.71671176,  0.38839832,
                    -0.0447705 , -0.37408817, -0.54168993, -0.63235403,
                    -0.68854106, -0.73009114, -0.77557515, -0.83646199,
                    -0.90727409, -0.96678609, -0.99412073, -0.98115084,
                    -0.91464362, -0.86487272]  ,
  [ 1.        ,  0.97675464,  0.91309735,  0.81483598,
                     0.68776048,  0.54145509,  0.356047  ,  0.07505937,
                    -0.27078587, -0.54430734, -0.69507961, -0.7767072 ,
                    -0.83691193, -0.89841152, -0.95718726, -0.99162144,
                    -0.98731967, -0.94645584, -0.88913329, -0.83851429,
                    -0.79545805, -0.74341971, -0.66076395, -0.51177904,
                    -0.23890101,  0.12733442,  0.44806787,  0.67192979,
                     0.82803476,  0.92811215,  0.98193719,  0.99386275,
                     0.96436875,  0.89623702,  0.81078486,  0.74190391,
                     0.67797163,  0.55832266,  0.34339538,  0.08154001,
                    -0.16563235, -0.4104427 , -0.63470335, -0.79523119,
                    -0.90028692, -0.96633061, -0.99411865, -0.98105052,
                    -0.90625289, -0.84829188]  ]

#optimized pulse for target state 4:
p4= [ [ 0.        ,  0.05226571,  0.08922968,  0.02728346,
                    -0.06148118, -0.1098464 , -0.0770149 ,  0.03203154,
                     0.16936618,  0.27747521,  0.33059662,  0.33306686,
                     0.2959793 ,  0.22850056,  0.1397867 ,  0.04027603,
                    -0.06022433, -0.1541651 , -0.23514679, -0.29607121,
                    -0.3290324 , -0.32583579, -0.27761437, -0.17877651,
                    -0.04474393,  0.07512001,  0.12640284,  0.09199601,
                     0.00642431, -0.06081183, -0.05392293,  0.02291382,
                     0.1041392 ,  0.1164367 ,  0.03828353, -0.08460066,
                    -0.17547234, -0.18456074, -0.10915923,  0.01476446,
                     0.13205233,  0.20636726,  0.23440393,  0.22491314,
                     0.18282199,  0.11097245,  0.01780272, -0.08064779,
                    -0.18693375, -0.24504804]  ,
  [ 0.        ,  0.09808332,  0.26526431,  0.36540235,
                     0.37371903,  0.27817738,  0.1203236 , -0.00566675,
                    -0.02549595,  0.05479226,  0.16969065,  0.25227537,
                     0.27293795,  0.23265786,  0.14737757,  0.04273375,
                    -0.05419263, -0.12601394, -0.16750695, -0.18032846,
                    -0.17036779, -0.1513413 , -0.14787905, -0.18673829,
                    -0.27316049, -0.37481726, -0.44218002, -0.44147619,
                    -0.36377366, -0.23101591, -0.09309108,  0.02111732,
                     0.13200133,  0.25916072,  0.37593024,  0.4377871 ,
                     0.42545222,  0.34927503,  0.24646036,  0.17035938,
                     0.15333085,  0.18325028,  0.22100245,  0.23073785,
                     0.19536859,  0.11822921,  0.01953551, -0.07443169,
                    -0.15629544, -0.1955156 ]  ,
  [ 0.        ,  0.04588429,  0.06702812, -0.01029039,
                    -0.10006305, -0.12960332, -0.06798722,  0.06291774,
                     0.20473387,  0.30455858,  0.34706274,  0.34172655,
                     0.30004269,  0.23007789,  0.1401441 ,  0.04027883,
                    -0.06064785, -0.15695113, -0.24387083, -0.31413921,
                    -0.35788816, -0.36493167, -0.32536453, -0.23185341,
                    -0.09573888,  0.03534167,  0.10437575,  0.0900509 ,
                     0.01789404, -0.04942574, -0.04974215,  0.02458273,
                     0.11204133,  0.13370775,  0.06049335, -0.06346499,
                    -0.15816565, -0.17244358, -0.10117482,  0.02685854,
                     0.1571323 ,  0.24326029,  0.27393418,  0.2571823 ,
                     0.20167817,  0.11739761,  0.01863758, -0.08152673,
                    -0.20036149, -0.27000376]  ,
  [ 1.        ,  0.97675464,  0.91319347,  0.81549403,
                     0.68784198,  0.53772374,  0.36721975,  0.16934516,
                    -0.05925241, -0.29480455, -0.49873911, -0.65717509,
                    -0.78192555, -0.88253938, -0.95525011, -0.99159311,
                    -0.98721635, -0.94266858, -0.86403058, -0.76153876,
                    -0.63895314, -0.48463296, -0.28055133, -0.03138328,
                     0.22056546,  0.4326204 ,  0.59826612,  0.73222735,
                     0.84393196,  0.93013429,  0.98200269,  0.99386471,
                     0.96464169,  0.89731722,  0.80188388,  0.69409942,
                     0.584175  ,  0.46568788,  0.31402782,  0.10035297,
                    -0.16833153, -0.43242727, -0.64078815, -0.79130613,
                    -0.89804446, -0.96605894, -0.99411689, -0.98096173,
                    -0.90225878, -0.84048118]  ,
  [ 1.        ,  0.97675464,  0.91311714,  0.81543741,
                     0.69207567,  0.5600503 ,  0.4250497 ,  0.2713613 ,
                     0.0784467 , -0.1546092 , -0.39658931, -0.60549401,
                    -0.76430483, -0.87892601, -0.95492724, -0.99158919,
                    -0.98720264, -0.94210184, -0.85936765, -0.74421051,
                    -0.60232827, -0.44125812, -0.27142906, -0.09948127,
                     0.07910587,  0.27470351,  0.48395816,  0.67864988,
                     0.82901811,  0.92812987,  0.98193336,  0.99386276,
                     0.96428491,  0.8919059 ,  0.77028329,  0.59265664,
                     0.37369162,  0.14967635, -0.05592494, -0.24150182,
                    -0.40780057, -0.5544769 , -0.68527727, -0.80243037,
                    -0.89968431, -0.96615464, -0.99411731, -0.98098161,
                    -0.90386547, -0.8436548 ]  ,
  [ 1.        ,  0.97675464,  0.91318194,  0.81523135,
                     0.68607489,  0.53151869,  0.35267059,  0.14420392,
                    -0.09078602, -0.32243989, -0.51569861, -0.66468725,
                    -0.78427765, -0.88299498, -0.95528967, -0.9915936 ,
                    -0.98721809, -0.94273574, -0.86450099, -0.76276024,
                    -0.63943108, -0.47842155, -0.25826102,  0.01032166,
                     0.27109619,  0.47570557,  0.62491453,  0.74378198,
                     0.84711158,  0.93058281,  0.98201975,  0.99386524,
                     0.96473528,  0.89866118,  0.80938305,  0.71802674,
                     0.63735195,  0.56020134,  0.46145093,  0.3033419 ,
                     0.05275908, -0.26602831, -0.56084656, -0.76747698,
                    -0.89399712, -0.96578756, -0.99411557, -0.9808966 ,
                    -0.89715743, -0.83040871]  ]

#optimized pulse for target state 5:
p5 = [ [ 0.        ,  0.06015766,  0.168801  ,  0.28432699,
                     0.41806894,  0.53620721,  0.62365847,  0.68241693,
                     0.71496949,  0.72175697,  0.70184377,  0.6491082 ,
                     0.54858438,  0.38884062,  0.20150694,  0.04922915,
                    -0.07217064, -0.24426871, -0.47802097, -0.67411543,
                    -0.77812927, -0.81574437, -0.80740165, -0.7377413 ,
                    -0.53259476, -0.16573331,  0.15046648,  0.2366264 ,
                     0.14796601,  0.01311288, -0.03690484,  0.0206187 ,
                     0.05491234, -0.10350283, -0.41534603, -0.65657159,
                    -0.74848553, -0.74193448, -0.58771025, -0.06573984,
                     0.50710694,  0.72956996,  0.76669869,  0.71397862,
                     0.5435271 ,  0.26775867,  0.04423182, -0.05460277,
                    -0.20601911, -0.32839   ]  ,
  [ 0.        ,  0.09818212,  0.29368707,  0.4591325 ,
                     0.54397196,  0.53389463,  0.46472822,  0.42447508,
                     0.48796524,  0.61667656,  0.71862145,  0.75517118,
                     0.72126584,  0.58293946,  0.32387002,  0.07863017,
                    -0.03747274, -0.10699502, -0.19375737, -0.21441791,
                    -0.07971277,  0.126037  ,  0.20494916,  0.06078812,
                    -0.19004127, -0.34644457, -0.358994  , -0.30223199,
                    -0.22806628, -0.14996774, -0.06904365,  0.02813406,
                     0.15957334,  0.30996408,  0.43404087,  0.49088521,
                     0.45894544,  0.34006337,  0.21905299,  0.24639847,
                     0.3959515 ,  0.50426142,  0.51489298,  0.44317567,
                     0.31042987,  0.15626781,  0.02497098, -0.06962874,
                    -0.17719683, -0.24551783]  ,
  [ 0.        ,  0.04973233,  0.13115924,  0.22008977,
                     0.35244949,  0.49506783,  0.61105621,  0.69007568,
                     0.73459954,  0.74714033,  0.72826258,  0.67247469,
                     0.56501931,  0.39634646,  0.20294681,  0.04917473,
                    -0.0720125 , -0.2420496 , -0.47228553, -0.6671652 ,
                    -0.77236667, -0.81161856, -0.80572204, -0.74228176,
                    -0.55829234, -0.23129386,  0.05939389,  0.15227703,
                     0.08891073, -0.01432478, -0.04323188,  0.01979096,
                     0.05587359, -0.08838122, -0.38201257, -0.6189085 ,
                    -0.71379266, -0.7061209 , -0.54124125, -0.04918778,
                     0.47598848,  0.69324714,  0.73885676,  0.69554018,
                     0.53758995,  0.27049752,  0.04697481, -0.03744917,
                    -0.12791198, -0.2049227 ]  ,
  [ 1.        ,  0.97675464,  0.91300452,  0.81298744,
                     0.67554983,  0.50655816,  0.3220574 ,  0.13509201,
                    -0.05810809, -0.26163964, -0.46112139, -0.63512302,
                    -0.77465796, -0.88140478, -0.95521048, -0.99159356,
                    -0.98721971, -0.9426684 , -0.86170237, -0.73844433,
                    -0.53246349, -0.19450438,  0.19860118,  0.48134451,
                     0.61783307,  0.68063865,  0.72788539,  0.78684258,
                     0.86003656,  0.93260225,  0.98209664,  0.99386735,
                     0.96513137,  0.90424785,  0.83447368,  0.77223861,
                     0.70395805,  0.5960125 ,  0.40550567,  0.12679404,
                    -0.15246356, -0.38402766, -0.59508807, -0.7725437 ,
                    -0.89478732, -0.9658931 , -0.99411645, -0.98094528,
                    -0.90024769, -0.83649191]  ,
  [ 1.        ,  0.97675464,  0.91296146,  0.81308524,
                     0.68126064,  0.53898205,  0.41219133,  0.30038985,
                     0.16945042, -0.0263694 , -0.29287653, -0.55854699,
                    -0.7536449 , -0.87830241, -0.95506015, -0.99159331,
                    -0.98722089, -0.94279673, -0.86487007, -0.76650538,
                    -0.66272142, -0.5592142 , -0.44422672, -0.29861413,
                    -0.11975167,  0.08343619,  0.32729033,  0.59467601,
                     0.80480909,  0.92488349,  0.98181296,  0.99385886,
                     0.96361761,  0.88288649,  0.72598221,  0.49426326,
                     0.26924271,  0.11201256, -0.01214611, -0.15247654,
                    -0.32063541, -0.49366546, -0.64968538, -0.78623159,
                    -0.89546494, -0.96576951, -0.99411508, -0.98086805,
                    -0.89585792, -0.82786677]  ,
  [ 1.        ,  0.97675464,  0.91304046,  0.81365534,
                     0.68001047,  0.52149576,  0.35196651,  0.17601759,
                    -0.01557143, -0.22582483, -0.43622638, -0.62127758,
                    -0.7690934 , -0.88005646, -0.95507085, -0.99159167,
                    -0.98721283, -0.94240074, -0.85971138, -0.73178168,
                    -0.52057208, -0.18605509,  0.19607974,  0.47401224,
                     0.61439154,  0.6830072 ,  0.73265478,  0.78985293,
                     0.86082529,  0.93266058,  0.98209677,  0.99386734,
                     0.96512904,  0.90424706,  0.83518152,  0.77714403,
                     0.72069818,  0.63767995,  0.49517894,  0.28213059,
                     0.03185794, -0.23902177, -0.51618478, -0.74408452,
                    -0.8893611 , -0.96549481, -0.99411436, -0.98083978,
                    -0.89178142, -0.81977032]  ]

#optimized pulse for target state 6:
p6 = [ [ 0.        ,  0.09789135,  0.29439651,  0.47961594,
                     0.61674718,  0.69022042,  0.72059639,  0.72745461,
                     0.72211434,  0.70833312,  0.68131551,  0.62680749,
                     0.52377331,  0.36385795,  0.18609087,  0.04540935,
                    -0.07674716, -0.25636802, -0.48791893, -0.67370558,
                    -0.76987695, -0.8029245 , -0.79372211, -0.74021189,
                    -0.62216054, -0.4327262 , -0.2376215 , -0.13109107,
                    -0.11927126, -0.12359761, -0.07401877,  0.01034434,
                     0.01557937, -0.15617091, -0.42192817, -0.60592137,
                    -0.65515551, -0.56218081, -0.19049129,  0.35309759,
                     0.69353817,  0.79511307,  0.80850418,  0.75701429,
                     0.5932348 ,  0.30065024,  0.05259404, -0.03435904,
                    -0.14453372, -0.24302803]  ,
  [ 0.        ,  0.0553233 ,  0.18057697,  0.36122025,
                     0.56185276,  0.69843333,  0.76582135,  0.79694325,
                     0.81471717,  0.82667129,  0.82903061,  0.81059843,
                     0.74759352,  0.5897668 ,  0.32148973,  0.07710488,
                    -0.03673327, -0.10239682, -0.19992299, -0.28848765,
                    -0.30211928, -0.25583236, -0.23746492, -0.30741311,
                    -0.42317129, -0.51252716, -0.54642027, -0.51316954,
                    -0.40066567, -0.23431867, -0.08673054,  0.0331082 ,
                     0.21904806,  0.48096277,  0.69027024,  0.78748708,
                     0.81193021,  0.78855395,  0.72120112,  0.62774224,
                     0.54789078,  0.49532022,  0.4383494 ,  0.34674069,
                     0.23060925,  0.11877023,  0.01661654, -0.09662431,
                    -0.26925158, -0.37891872]  ,
  [ 0.        ,  0.10039193,  0.31398687,  0.52492719,
                     0.67503225,  0.74891965,  0.77587214,  0.77866881,
                     0.76927549,  0.75179993,  0.72171241,  0.66393484,
                     0.55397254,  0.38051579,  0.18980498,  0.04502554,
                    -0.08216872, -0.28091538, -0.52975646, -0.71417523,
                    -0.80172501, -0.82928758, -0.81714335, -0.75802763,
                    -0.61476212, -0.35883462, -0.09266978,  0.02899606,
                     0.00098257, -0.06251104, -0.05747997,  0.015015  ,
                     0.03457642, -0.12677536, -0.40862369, -0.61679218,
                    -0.68114202, -0.60232456, -0.22081615,  0.35848644,
                     0.71256218,  0.80589358,  0.81116214,  0.74802929,
                     0.56739029,  0.27617445,  0.0438575 , -0.06991413,
                    -0.28303153, -0.45270365]  ,
  [ 1.        ,  0.97675464,  0.91291678,  0.81209838,
                     0.67389042,  0.5124528 ,  0.3565532 ,  0.22293234,
                     0.09511447, -0.06501033, -0.28197308, -0.52599799,
                    -0.73286793, -0.87222863, -0.9543322 , -0.99158212,
                    -0.98717842, -0.94094802, -0.84637896, -0.66931829,
                    -0.34518404,  0.08729747,  0.43512963,  0.60752675,
                     0.67487386,  0.70347515,  0.73154151,  0.78188356,
                     0.85584371,  0.93151622,  0.98204193,  0.99386556,
                     0.96481321,  0.89991505,  0.81424394,  0.72163161,
                     0.61330611,  0.44657469,  0.176297  , -0.11566627,
                    -0.31697978, -0.46132107, -0.61481186, -0.77200433,
                    -0.89361489, -0.96577485, -0.99411584, -0.98091618,
                    -0.89877967, -0.83361405]  ,
  [ 1.        ,  0.97675464,  0.91294515,  0.81179525,
                     0.66686909,  0.47428154,  0.2522668 ,  0.04032716,
                    -0.1447552 , -0.3192341 , -0.49150789, -0.64896336,
                    -0.78013365, -0.88299194, -0.95542985, -0.99159732,
                    -0.98723429, -0.94334122, -0.86922671, -0.78223389,
                    -0.69699232, -0.61321279, -0.51107779, -0.35815162,
                    -0.13744025,  0.12108415,  0.37854506,  0.61898265,
                     0.80926388,  0.92528192,  0.98182799,  0.99385949,
                     0.96370771,  0.88349866,  0.72482503,  0.48097447,
                     0.2469589 ,  0.13143756,  0.10456396,  0.03794441,
                    -0.15489167, -0.40789855, -0.61797769, -0.77741263,
                    -0.89452741, -0.96577752, -0.99411542, -0.98088844,
                    -0.89707262, -0.83025542]  ,
  [ 1.        ,  0.97675464,  0.91282373,  0.81058735,
                     0.66564155,  0.49095198,  0.32528   ,  0.19542139,
                     0.07936984, -0.07491812, -0.2948264 , -0.53936226,
                    -0.74026866, -0.87427102, -0.95455887, -0.99158534,
                    -0.98719041, -0.94143867, -0.85063947, -0.6883186 ,
                    -0.39555952,  0.01550259,  0.37425456,  0.56514242,
                     0.64203311,  0.67884959,  0.71761921,  0.7773936 ,
                     0.85542264,  0.93160162,  0.98204883,  0.99386578,
                     0.96485779,  0.90063562,  0.81762233,  0.72793289,
                     0.61663218,  0.43791068,  0.16004117, -0.12205608,
                    -0.32193091, -0.48491722, -0.64574984, -0.78998512,
                    -0.89822238, -0.96617172, -0.99411804, -0.98102573,
                    -0.90640752, -0.84865069]  ]

#optimized pulse for target state 7:
p7 = [ [ 0.        ,  0.08783536,  0.30304213,  0.54987067,
                     0.72956387,  0.81455995,  0.8473369 ,  0.8534423 ,
                     0.84085676,  0.80894332,  0.75311276,  0.66873243,
                     0.5491475 ,  0.38653529,  0.20274035,  0.0505362 ,
                    -0.06498878, -0.212754  , -0.42604329, -0.62961373,
                    -0.75466759, -0.81409501, -0.83735275, -0.83646769,
                    -0.80938616, -0.74202621, -0.61260338, -0.42809767,
                    -0.25616071, -0.14735991, -0.06882728,  0.02172779,
                     0.10117737,  0.10519909,  0.00252434, -0.14955015,
                    -0.23049475, -0.12234674,  0.19725359,  0.52769923,
                     0.70197755,  0.76516246,  0.76946654,  0.71194655,
                     0.5453999 ,  0.27119973,  0.04535965, -0.05710323,
                    -0.2407458 , -0.39257461]  ,
  [ 0.        ,  0.02787369, -0.01038596, -0.12185762,
                    -0.05477121,  0.3087939 ,  0.67554902,  0.8274244 ,
                     0.87677962,  0.89366913,  0.89426735,  0.87752839,
                     0.82621767,  0.68375085,  0.3894693 ,  0.09511647,
                    -0.02612059, -0.09172821, -0.25089838, -0.45276568,
                    -0.59132177, -0.66210391, -0.70034175, -0.71638524,
                    -0.70245879, -0.6501986 , -0.55439773, -0.42059721,
                    -0.27776754, -0.15893003, -0.06776448,  0.03417909,
                     0.21830555,  0.48775541,  0.71974725,  0.84135719,
                     0.89171281,  0.90872326,  0.90469522,  0.87469964,
                     0.78577804,  0.54598596,  0.16804886, -0.0704836 ,
                    -0.04942074,  0.02722452,  0.00678702, -0.08003261,
                    -0.11888187, -0.11234462]  ,
  [ 0.        ,  0.09049183,  0.31213729,  0.56256324,
                     0.74081615,  0.82369369,  0.85511029,  0.86067   ,
                     0.84888545,  0.82057929,  0.77280747,  0.69871713,
                     0.58297949,  0.41031998,  0.21056815,  0.05089912,
                    -0.07097796, -0.2436723 , -0.48476728, -0.68938357,
                    -0.79864538, -0.84442375, -0.85739734, -0.84644401,
                    -0.80400674, -0.70362699, -0.51418064, -0.28424294,
                    -0.1338945 , -0.08649228, -0.05341894,  0.02505628,
                     0.11120695,  0.11378664, -0.01436155, -0.19707464,
                    -0.27311956, -0.0997582 ,  0.28347628,  0.60592982,
                     0.74366123,  0.78370532,  0.76854726,  0.68395053,
                     0.48706043,  0.22358628,  0.03059182, -0.11281078,
                    -0.40861703, -0.62311665]  ,
  [ 1.        ,  0.97675464,  0.912624  ,  0.80620756,
                     0.63363197,  0.38362916,  0.12556457, -0.0451406 ,
                    -0.12316763, -0.18063324, -0.29713383, -0.4938988 ,
                    -0.70793203, -0.86526023, -0.95361838, -0.99157241,
                    -0.98714227, -0.93946785, -0.83378353, -0.62416887,
                    -0.28133094,  0.09728885,  0.35724468,  0.47408221,
                     0.51971735,  0.5530989 ,  0.61324489,  0.71492313,
                     0.83318724,  0.92803673,  0.98191204,  0.9938617 ,
                     0.96412893,  0.890447  ,  0.76583801,  0.58091093,
                     0.32424255,  0.036434  , -0.15499066, -0.19047984,
                    -0.17177169, -0.24736568, -0.46770805, -0.72009689,
                    -0.88524646, -0.96524938, -0.99411324, -0.98078457,
                    -0.88657476, -0.80946738]  ,
  [ 1.        ,  0.97675464,  0.913075  ,  0.81267005,
                     0.66593155,  0.4371806 ,  0.08843161, -0.27628204,
                    -0.50761584, -0.61483767, -0.67417857, -0.73254341,
                    -0.80677041, -0.88826866, -0.95592112, -0.99160388,
                    -0.9872578 , -0.94428402, -0.87614009, -0.80393713,
                    -0.73763188, -0.66857335, -0.57152189, -0.40489934,
                    -0.15071809,  0.13163258,  0.38982623,  0.62432299,
                     0.81038415,  0.92523929,  0.98181674,  0.99385883,
                     0.9636184 ,  0.88325586,  0.73554969,  0.56379824,
                     0.49273888,  0.55219584,  0.64087665,  0.68128208,
                     0.636152  ,  0.39272708, -0.1545177 , -0.66622951,
                    -0.88268214, -0.96518295, -0.99411273, -0.98075388,
                    -0.88454729, -0.80547382]  ,
  [ 1.        ,  0.97675464,  0.91260174,  0.80578313,
                     0.63077735,  0.37486007,  0.11192016, -0.05884464,
                    -0.13651276, -0.19549248, -0.31329448, -0.50888852,
                    -0.71689626, -0.86776141, -0.9538784 , -0.99157604,
                    -0.98715593, -0.94002973, -0.83844806, -0.6388108 ,
                    -0.30307716,  0.06716649,  0.31106366,  0.41235417,
                     0.44644713,  0.48005578,  0.55894158,  0.68843682,
                     0.82589046,  0.92711281,  0.98188021,  0.99386069,
                     0.96395988,  0.88823293,  0.75455106,  0.54734763,
                     0.26318653, -0.01601012, -0.15384086, -0.14658167,
                    -0.14107709, -0.27186587, -0.52085644, -0.75140823,
                    -0.89208052, -0.96576628, -0.99411596, -0.98092117,
                    -0.89813867, -0.83232205]  ]



# Hamiltonian components
Hz1z2 = qutip.Qobj(np.kron(np.kron(np.diag([1, -1]), np.diag([1, -1])), np.identity(2)))
Hz2z3 = qutip.Qobj(np.kron(np.kron(np.identity(2), np.diag([1, -1])), np.diag([1, -1])))

Hx1 = qutip.Qobj(np.kron(np.kron([[0, 1], [1, 0]], np.identity(2)), np.identity(2)))
Hx2 = qutip.Qobj(np.kron(np.kron(np.identity(2), [[0, 1], [1, 0]]), np.identity(2)))
Hx3 = qutip.Qobj(np.kron(np.kron(np.identity(2), np.identity(2)), [[0, 1],[1, 0]]))

Hz1 = qutip.Qobj(np.kron(np.kron([[1, 0], [0, -1]], np.identity(2)), np.identity(2)))
Hz2 = qutip.Qobj(np.kron(np.kron(np.identity(2), [[1, 0], [0, -1]]), np.identity(2)))
Hz3 = qutip.Qobj(np.kron(np.kron(np.identity(2), np.identity(2)), [[1, 0], [0, -1]]))
